dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stflife + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(reg_log)
augment(reg_log)
glance(reg_log)
reg_log_df <-  broom::tidy(reg_log$coefficients)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
options(scipen = 999999)
View(reg_log)
diag(solve(cor(dane[,c(1:11)])))
options(scipen = 999999)
View(reg_log)
install.packages("readxl")
library(readxl)
install.packages("data.table")
library(data.table)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stflife","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stflife <- ifelse(dane$stflife <= 7,0,1)
print(unique(dane$stflife))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stflife + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(reg_log)
glance(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
View(reg_log)
reg_log_df <-  broom::tidy(reg_log$coefficients)
augment(reg_log)
confint(reg_log,sclmeet, level = 0.95)
install.packages("readxl")
library(readxl)
install.packages("data.table")
library(data.table)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stflife","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stflife <- ifelse(dane$stflife <= 7,0,1)
print(unique(dane$stflife))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stflife + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
reg_log_df <- tidy(reg_log)
glance(reg_log_df)
reg_log_df <- broom::tidy(reg_log$coefficients)
reg_log_df <- broom::tidy(reg_log)
glance(reg_log_df)
augment(reg_log_df)
print(coef(reg_log_df))
print(coef(reg_log_df))
exp_coef <- exp(coef(reg_log_df))
library(broom)
tidy(reg_log)
glance(reg_log)
augment(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
View(reg_log)
confint(reg_log, level = 0.95)
library(rsq)
AIC(reg_log)
BIC(reg_log)
install.packages("rsq")
library(rsq)
rsq::mcfadden(reg_log)
r2 <- rsq::r2_logistic(reg_log)
pull(r.squared)
library(broom)
tidy(reg_log)
glance(reg_log)
glance(reg_log) %>%
pull(r.squared)
reg_log %>%
glance() %>%
pull(r.squared)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
install.packages("dplyr")
library(dplyr)
reg_log %>%
glance() %>%
pull(r.squared)
model <- tiggle(reg_log)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stflife + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
model <- tibble(reg_log)
install.packages("tidyverse")
library(tidyverse)
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
model <- tibble(reg_log)
library(tibble)
model <- tibble(reg_log)
model <- tibble(happy)
model <- tibble(happy)
model <- tibble(dane$happy)
model <- tibble(dane$happy)
tidy(model)
library(broom)
tidy(model)
model %>%
glance() %>%
pull(r.squared)
install.packages("dplyr")
library(dplyr)
install.packages("dplyr")
model %>%
glance() %>%
pull(r.squared)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
View(reg_log)
print(coef(reg_log))
print(exp_coef)
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
install.packages("readxl")
library(readxl)
install.packages("data.table")
library(data.table)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(model)
augment(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
#confint(reg_log, level = 0.95)
View(reg_log_df)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(model)
augment(reg_log)
library(readxl)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(model)
augment(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
#confint(reg_log, level = 0.95)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
library(readxl)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(model)
library(broom)
tidy(reg_log)
augment(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
library(readxl)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(reg_log)
augment(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
augment(reg_log)
tiggle(reg_log)
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
dane <- read_excel("data/baza.xlsx")
library(readxl)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(reg_log)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log$'Exp(B)' <- exp(reg_log$estimate)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
library(data.table)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
library(readxl)
library(data.table)
dane <- read_excel("data/baza.xlsx")
head(dane)
dane <- subset(dane,!agea %in% c(999) & !is.na(agea))
print(unique(dane$agea))
dane <- subset(dane,!health %in% c(7,8,9) & !is.na(health))
print(unique(dane$health))
dane <- subset(dane,!gndr %in% c(9) & !is.na(gndr))
print(unique(dane$gndr))
for(i in c("happy","cntry","sclmeet", "inprdsc","stfeco", "stfgov","stfdem","stfedu","stfhlth","gndr","marsts","nbthcld","hinctnta")){
dane <- subset(dane,!get(i) %in% c(66,77,88,99) & !is.na(get(i)))
}
print(unique(dane$happy))
dane$happy <- ifelse(dane$happy <= 7,0,1)
print(unique(dane$happy))
dane$sclmeet <- ifelse(dane$sclmeet <= 4,0,1)
print(unique(dane$sclmeet))
dane$stfeco <- ifelse(dane$stfeco <= 7,0,1)
print(unique(dane$stfeco))
dane$stfgov <- ifelse(dane$stfgov <= 7,0,1)
print(unique(dane$stfgov))
dane$stfdem <- ifelse(dane$stfdem <= 7,0,1)
print(unique(dane$stfdem))
dane$stfedu <- ifelse(dane$stfedu <= 7,0,1)
print(unique(dane$stfedu))
dane$stfhlth <- ifelse(dane$stfhlth <= 7,0,1)
print(unique(dane$stfhlth))
dane$health <- ifelse(dane$health <= 2,1,0)
print(unique(dane$health))
dane$marsts <- ifelse(dane$marsts <= 2,1,0)
print(unique(dane$marsts))
str(dane)
reg_log <- glm(happy ~ cntry + sclmeet + inprdsc + health + stfeco + stfgov + stfdem + stfedu + stfhlth + gndr + agea + marsts + nbthcld  + hinctnta, data = dane, family = "binomial")
summary(reg_log)
library(broom)
tidy(reg_log)
View(reg_log)
augment(reg_log)
print(coef(reg_log))
exp_coef <- exp(coef(reg_log))
print(exp_coef)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
confint(reg_log, level = 0.95)
#reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
View(reg_log_df)
reg_log_df <- broom::tidy(reg_log$coefficients)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df <- tidy(reg_log$coefficients)
reg_log_df$'Exp(B)' <- exp(reg_log_df$estimate)
reg_log_df <- tidy(reg_log$coefficients)
reg_log_df$'Exp(B)' <- exp(reg_log_df$x)
View(reg_log_df)
reg_log_df <- tidy(reg_log$coefficients)
reg_log_df$'Exp(B)' <- exp(reg_log_df$x)
View(reg_log_df)
set.seed(20230228)
rnorm(n=10) # randomowe 10 liczb
set.seed(20230228)
rbinom(n=10,size=1,prob=0.7)
set.seed(20230228)
rbinom(n=10,size=50,prob=0.7)
# wynik to ilość sukcesów
set.seed(20230228)
rpois(n=10,lambda=1.5)
rpois(10,1.5)
exp(1,21526)
exp(1,21526)
exp(1.21526)
exp(1)
exp(1)
